{"version":3,"sources":["../../js/upload.js","../../js/signin.js","../../js/gallery.js","../../js/tags.js"],"names":["scrollTo","element","$","animate","scrollTop","offset","top","imgpopover_getTitle","file","uploader","getFile","this","data","name","imgpopover_getContent","source","getSource","img","moxie","image","Image","onload","id","attr","getAsDataURL","load","on_keyboard_action","event","k","keyCode","ctrl_pressed","window","Clipboard","pasteCatcher","focus","on_keyboardup_action","dataURLtoBlob","dataurl","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","Blob","type","pasteHandler","e","clipboardData","items","i","indexOf","blob","getAsFile","paste_createImage","setTimeout","paste_check_Input","child","childNodes","innerHTML","cild","tagName","src","pad","number","slice","getDateString","date","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getExtension","File","addFile","onGooglePlatformSignIn","googleUser","id_token","getAuthResponse","url","post","status","get","replaceWith","signOut","onGooglePlatformSignInFailure","error","console","log","onGooglePlatformLoaded","gapi","auth2","init","signin2","render","scope","onsuccess","onfailure","serverSignOut","location","reload","getAuthInstance","then","blueimp","on","index","slide","gallery","item","list","bbq","pushState","viewer","removeState","hashchange","getState","close","getIndex","document","ready","click","plupload","redirect","href","uploading","Uploader","browse_button","container","drop_element","multipart","runtimes","PostInit","append","prop","settings","tags","val","uploadid","csrf_token","submit","start","FilesAdded","up","files","show","each","div","formatSize","size","refresh","FilesRemoved","remove","UploadFile","html","after","addClass","UploadProgress","css","percent","Error","err","FileUploaded","response","obj","JSON","parse","trigger","message","code","UploadComplete","addEventListener","stopPropagation","preventDefault","fadeIn","dropbox","getElementById","dropboxHideTimer","clearTimeout","delegate","removeFile","popover","selector","template","title","content","onkeydown","onkeyup","createElement","setAttribute","style","cssText","marginLeft","body","appendChild","children","firstElementChild","fn","select2","tokenSeparators","ajax","delay","processResults","page","results"],"mappings":"AA8HA,QAASA,UAASC,GACjBC,EAAA,cAAgBC,SACfC,UAAWH,EAAQI,SAASC,KAC1B,KAGJ,QAASC,uBACR,GAAIC,GAAOC,SAASC,QAAOR,EAAGS,MAAMC,KAAI,QACxC,OAAOJ,GAAKK,KAGb,QAASC,yBACR,GAAIN,GAAOC,SAASC,QAAOR,EAAGS,MAAMC,KAAI,SACpCG,EAASP,EAAKQ,YACdC,EAAM,GAAIC,OAAMC,MAAMC,KAK1B,OAJAH,GAAII,OAAS,WACZnB,EAAA,OAAWM,EAAKc,IAAIC,KAAI,MAAQZ,KAAKa,iBAEtCP,EAAIQ,KAAKV,GACF,eAAiBP,EAAKc,GAAK,8BAuBnC,QAASI,oBAAmBC,GAC3BC,EAAID,EAAME,QAEH,IAAHD,IACgB,GAAhBE,eACFA,cAAe,GACXC,OAAOC,WACXC,aAAaC,SAGhB,QAASC,sBAAqBR,GAC7BC,EAAID,EAAME,QAEJ,IAAHD,IACFE,cAAe,GA0BjB,QAASM,eAAcC,GAMnB,IALA,GAAIC,GAAMD,EAAQE,MAAK,KACnBC,EAAOF,EAAI,GAAGG,MAAK,WAAY,GAC/BC,EAAOC,KAAKL,EAAI,IAChBM,EAAIF,EAAKG,OACTC,EAAQ,GAAIC,YAAWH,GACrBA,KACFE,EAAMF,GAAKF,EAAKM,WAAWJ,EAE/B,OAAO,IAAIK,OAAMH,IAASI,KAAKV,IAGnC,QAASW,cAAaC,GACrB,GAAGA,EAAEC,cAAe,CACnB,GAAIC,GAAQF,EAAEC,cAAcC,KAC5B,IAAIA,EACH,IAAK,GAAIC,GAAI,EAAGA,EAAID,EAAMT,OAAQU,IACjC,GAAID,EAAMC,GAAGL,KAAKM,QAAO,cAAkB,CAC1C,GAAIC,GAAOH,EAAMC,GAAGG,WAGpBC,mBAAkBF,QAKrBG,YAAWC,kBAAmB,GAOhC,QAASA,qBACR,GAAIC,GAAQ7B,aAAa8B,WAAW,EACpC9B,cAAa+B,UAAY,GACrBF,GACkB,QAAjBG,KAAKC,SACRP,kBAAkBG,EAAMK,KAK3B,QAASC,KAAIC,GACZ,OAAO,IAAOA,GAAQC,UAGvB,QAASC,iBACR,GAAIC,GAAO,GAAIC,KACf,OAAOD,GAAKE,cAAgB,IAAMN,IAAII,EAAKG,WAAa,GAAK,IAAMP,IAAII,EAAKI,WAC3E,IAAMR,IAAII,EAAKK,YAAcT,IAAII,EAAKM,cAAgBV,IAAII,EAAKO,cAGjE,QAASC,cAAavB,GACrB,OAAOA,EAAKP,MACZ,IAAK,YACJ,MAAO,MACR,KAAK,aACJ,MAAO,MACR,KAAK,YACJ,MAAO,MACR,KAAK,YACJ,MAAO,QAIT,QAASS,mBAAkBF,GAE1B,GACIjD,IADQ,GAAIU,OAAMC,MAAMC,MACjB,GAAIF,OAAMV,KAAKyE,KAAK,KAAMxB,GACrCjD,GAAKK,KAAO,aAAe0D,gBAAkBS,aAAavB,GAC1DhD,SAASyE,QAAQ1E,GCvRlB,QAAS2E,wBAAuBC,GAC/B,GAAIC,GAAWD,EAAWE,kBAAkBD,SACxCE,EAAMrF,EAAA,oBAAsBU,KAAI,YACpCV,GAAEsF,KAAKD,GAAOF,SAAYA,GAAY,SAASzE,GAC9C,GAA2B,mBAAhBA,GAAW,QAAmC,MAAfA,EAAK6E,OAAgB,CAC9D,GAAIF,GAAMrF,EAAA,oBAAsBU,KAAI,SACpCV,GAAEwF,IAAIH,EAAK,SAAS3E,GACnBV,EAAA,oBAAsByF,YAAY/E,SAGnCgF,aAMH,QAASC,+BAA8BC,GACtCC,QAAQC,IAAIF,GAGb,QAASG,0BACRC,KAAKzE,KAAI,QAAU,WACNyE,KAAKC,MAAMC,MACvBF,MAAKG,QAAQC,OAAM,mBAClBC,MAAS,QACTC,UAAarB,uBACbsB,UAAaZ,kCAKhB,QAASa,iBACR,GAAInB,GAAMrF,EAAA,qBAAuBU,KAAI,aACrCV,GAAEwF,IAAIH,EAAK,SAAS3E,GACnB+F,SAASC,QAAO,KAIlB,QAAShB,WACR,GAAIO,GAAQD,KAAKC,MAAMU,iBACvBV,GAAMP,UAAUkB,KAAKJ,eDxCtB,GEAuB,mBAAZK,WAEX7G,EAAA,oBACE8G,GAAE,OAAS,SAAUrF,GACrBzB,EAAA,uBAAyBqB,KAAI,UAAY,6FAEzCyF,GAAE,SAAW,SAAUrF,GACvBzB,EAAA,uBAAyBqB,KAAI,UAAY,yCAEzCyF,GAAE,QAAU,SAAUrF,EAAOsF,EAAOC,GACpC,GAAIC,GAAUjH,EAAA,oBAAsBU,KAAI,WACpCwG,EAAOlH,EAAEiH,EAAQE,KAAKJ,GAE1B/G,GAAEoH,IAAIC,WAASC,OAAYJ,EAAKxG,KAAI,UAEpCoG,GAAE,QAAU,SAAUrF,EAAOsF,GAC7B/G,EAAEoH,IAAIG,YAAW,YAGnBvH,EAAE6B,QAAQ2F,WAAW,WACpB,GAAIP,GAAUjH,EAAA,oBAAsBU,KAAI,UACxC,IAAuB,mBAAZuG,GAAX,CAEA,GAAI7F,GAAKpB,EAAEoH,IAAIK,SAAQ,SACvB,IAAkB,mBAAPrG,GAEV,WADA6F,GAAQS,OAIT,KAAK,GAAIrE,GAAI,EAAGA,EAAI4D,EAAQE,KAAKxE,OAAQU,IAAK,CAC7C,GAAI6D,GAAOlH,EAAEiH,EAAQE,KAAK9D,GAC1B,IAAI6D,EAAKxG,KAAI,OAAUU,EAAI,CACtB6F,EAAQU,YAActE,GACzB4D,EAAQD,MAAM3D,EAEf,YAKHrD,EAAE4H,UAAUC,MAAM,WACjB,GAAIzG,GAAKpB,EAAEoH,IAAIK,SAAQ,SACL,oBAAPrG,IACVpB,EAAA,cAAkBoB,EAAK,KAAK0G,WF3CN,mBAAbC,UAA0B,CAErC,GAAIC,UAAWnG,OAAO4E,SAASwB,KAC3BC,WAAY,EAEZ3H,SAAW,GAAIwH,UAASI,UAC3BC,cAAe,YACf/C,IAAK,UACLgD,UAAW,aACXC,aAAc,UACdC,WAAW,EAEXC,SAAU,cAEVtC,MACCuC,SAAU,WACTzI,EAAA,UAAY8H,MAAM,WACjBI,WAAY,EAEZlI,EAAA,QAAU0I,OAAM,qBAEhB1I,EAAA,cAAgB2I,KAAI,YAAa,GACjC3I,EAAA,UAAY2I,KAAI,YAAa,GAC7B3I,EAAA,cAAgB2I,KAAI,YAAa,GAEjCpI,SAASqI,SAA0B,kBAClCC,KAAQ7I,EAAA,cAAgB8I,MACxBC,SAAY/I,EAAA,eAAiBU,KAAI,YACjCsI,WAAchJ,EAAA,eAAiBU,KAAI,QACnCuI,OAAU,UAEX1I,SAAS2I,WAIXC,WAAY,SAASC,EAAIC,GACxBrJ,EAAA,eAAiBsJ,OAEjBtJ,EAAEuJ,KAAKF,EAAO,SAAShG,EAAG/C,GACzBN,EAAA,eAAiB0I,OAAM,YAAepI,EAAKc,GAAK,KAChD,IAAIoI,GAAMxJ,EAAA,IAAQM,EAAKc,GAEvBoI,GAAId,OAAOpI,EAAKK,KAAO,KAAOoH,SAAS0B,WAAWnJ,EAAKoJ,MAAQ,MAC/DF,EAAId,OAAM,sFAAyFpI,EAAKc,GAAK,+EAG7GoI,EAAId,OAAM,+DAAkEpI,EAAKc,GAAK,mFAKvFgI,EAAGO,WAGJC,aAAc,SAASR,EAAIC,GAC1BrJ,EAAEuJ,KAAKF,EAAO,SAAShG,EAAG/C,GACzBN,EAAA,IAAQM,EAAKc,IAAIyI,YAInBC,WAAY,SAASV,EAAI9I,GACxB,GAAIkJ,GAAMxJ,EAAA,IAAQM,EAAKc,GACvBoI,GAAIO,KAAKzJ,EAAKK,KAAO,wEACrBb,SAAS0J,GACTA,EAAIQ,MAAK,YAAe1J,EAAKc,GAAK,gBAClCpB,EAAA,IAAQM,EAAKc,GAAK,YAAY6I,SAAQ,YAAavB,OAAM,2GAI1DwB,eAAgB,SAASd,EAAI9I,GAC5BN,EAAA,IAAQM,EAAKc,GAAK,0BAA0B+I,IAAG,QAAU7J,EAAK8J,QAAU,KAAKL,KAAKzJ,EAAK8J,QAAU,OAGlGC,MAAO,SAASjB,EAAIkB,GACnBtK,EAAA,IAAQsK,EAAIhK,KAAKc,GAAK,YAAYyI,SAClC7J,EAAA,IAAQsK,EAAIhK,KAAKc,IAAS2I,KAAKO,EAAIhK,KAAKK,KAAO,0FAE/CyI,EAAGO,WAGJY,aAAc,SAASnB,EAAI9I,EAAMkK,GAChCxK,EAAA,IAAQM,EAAKc,GAAK,YAAYyI,QAE9B,IAAIY,GAAMC,KAAKC,MAAMH,EAASA,SAE9B,OAA0B,mBAAfC,GAAU,QAAkC,MAAdA,EAAIlF,QAI5C6D,EAAGwB,QAAO,SACTC,QAASJ,EAAI7E,MAAMiF,QACnBC,KAAML,EAAI7E,MAAMkF,KAChBxK,KAAMA,KACA,IAPP0H,SAAWyC,EAAIzC,aACfhI,GAAA,IAAQM,EAAKc,IAAI2I,KAAKzJ,EAAKK,KAAO,0FAUpCoK,eAAgB,SAAS3B,EAAIC,GAC5BxH,OAAO4E,SAAWuB,YAKrBzH,UAAS2F,OAETrE,OAAOmJ,iBAAgB,YAAc,SAAU9H,GAC1CgF,YAEJhF,EAAE+H,kBACF/H,EAAEgI,iBAEFlL,EAAA,YAAcmL,YAEZ,EAEH,IAAIC,SAAUxD,SAASyD,eAAc,WACjCC,gBAEJF,SAAQJ,iBAAgB,WAAa,SAAS9H,GAC7CA,EAAE+H,kBACF/H,EAAEgI,iBAEFK,aAAaD,kBACbA,iBAAmB5H,WAAU,2BAA6B,OACxD,GAwBH1D,EAAA,eAAiBwL,SAAQ,cAAgB,QAAS,WACjDjL,SAASkL,WAAUzL,EAAGS,MAAMC,KAAI,WAGjCV,EAAA,QAAU0L,SACT3B,MAAM,EACNa,QAAS,cACTe,SAAU,eACVC,SAAU,+GACVC,MAAOxL,oBACPyL,QAASlL,wBAKVgH,SAASmE,UAAY,SAAS7I,GAAK,MAAO1B,oBAAmB0B,IAC7D0E,SAASoE,QAAU,SAAS9I,GAAK,MAAOjB,sBAAqBiB,GAE7D,IAAItB,eAAe,EAoBfG,YACCF,QAAOC,YACXC,aAAe6F,SAASqE,cAAa,OACrClK,aAAamK,aAAY,KAAO,YAChCnK,aAAamK,aAAY,kBAAoB,IAC7CnK,aAAaoK,MAAMC,QAAU,6CAC7BrK,aAAaoK,MAAME,WAAa,QAChCzE,SAAS0E,KAAKC,YAAYxK,cAC1BA,aAAaC,QAEb4F,SAASyD,eAAc,YAAaL,iBAAgB,qBAAuB,WAC1E,GAAmC,GAAhCjJ,aAAayK,SAAS7J,OAAW,CACnC5B,IAAMgB,aAAa0K,kBAAkBxI,GAErC,IAAIV,GAAOrB,cAAcnB,IAEzB0C,mBAAkBF,GAClBxB,aAAa+B,UAAY,MAExB,IAkCJjC,OAAOmJ,iBAAgB,QAAU/H,cCpMjCjD,EAAA,qBAAuB8H,MAAM,WAC5BpC,YE5C2B,mBAAjB1F,GAAE0M,GAAGC,SACf3M,EAAA,cAAgB2M,SAEf9D,MAAM,EACN+D,iBAAiB,KACjBC,MACCC,MAAO,IACPC,eAAgB,SAAUrM,EAAMsM,GAC/B,OACCC,QAASvM","file":"site.min.js","sourcesContent":["if (typeof plupload !== 'undefined') {\n\nvar redirect = window.location.href;\nvar uploading = false;\n\nvar uploader = new plupload.Uploader({\n\tbrowse_button: 'pickfiles',\n\turl: 'upload/',\n\tcontainer: 'uploadform',\n\tdrop_element: 'dropbox',\n\tmultipart: true,\n\t//html5,flash,silverlight,html4\n\truntimes: 'html5,html4', \n\t\n\tinit: {\n\t\tPostInit: function() {\n\t\t\t$('#upoad').click(function() {\n\t\t\t\tuploading = true;\n\t\t\t\t\n\t\t\t\t$('body').append('<div id=\"hide\" />');\n\t\t\t\t\n\t\t\t\t$('#pickfiles').prop('disabled', true);\n\t\t\t\t$('#upoad').prop('disabled', true);\n\t\t\t\t$('#inputtags').prop('disabled', true);\n\t\t\t\t\t\t\t\t\n\t\t\t\tuploader.settings['multipart_params'] = {\n\t\t\t\t\t'tags': $('#inputtags').val(),\n\t\t\t\t\t'uploadid': $('#uploadform').data('uploadid'),\n\t\t\t\t\t'csrf_token': $('#uploadform').data('csrf'),\n\t\t\t\t\t'submit': 'Upload'\n\t\t\t\t};\n\t\t\t\tuploader.start();\n\t\t\t});\n\t\t},\n\t\t\n\t\tFilesAdded: function(up, files) {\n\t\t\t$('#image-list').show();\n\t\t\t\n\t\t\t$.each(files, function(i, file) {\n\t\t\t\t$('#image-list').append('<div id=\"' + file.id + '\">');\n\t\t\t\tvar div = $('#' + file.id);\n\n\t\t\t\tdiv.append(file.name + ' (' + plupload.formatSize(file.size) + ') ');\n\t\t\t\tdiv.append('<a tabindex=\"0\" role=\"button\" class=\"img-popover\" data-toggle=\"popover\" data-file=\"' + file.id + '\">' + \n\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-picture\" aria-hidden=\"true\"></span>' + \n\t\t\t\t\t\t'</a> ');\n\t\t\t\tdiv.append('<a tabindex=\"0\" role=\"button\" class=\"img-remove\" data-file=\"' + file.id + '\">' +\n\t\t\t\t\t\t'<span class=\"glyphicon glyphicon-minus-sign\" aria-hidden=\"true\"></span>' +\n\t\t\t\t\t\t'</a>');\n\t\t\t});\n\t\t \n\t\t\tup.refresh(); // Reposition Flash/Silverlight\n\t\t},\n\t\t\n\t\tFilesRemoved: function(up, files) {\n\t\t\t$.each(files, function(i, file) {\n\t\t\t\t$('#' + file.id).remove();\n\t\t\t});\n\t\t},\n\n\t\tUploadFile: function(up, file) {\n\t\t\tvar div = $('#' + file.id);\n\t\t\tdiv.html(file.name + ' <span class=\"glyphicon glyphicon-upload\" aria-hidden=\"true\"></span>');\n\t\t\tscrollTo(div)\n\t\t\tdiv.after('<div id=\"' + file.id + 'progress\" />');\n\t\t\t$('#' + file.id + 'progress').addClass('progress').append('<div class=\"progress-bar\"' +\n\t\t\t\t\t'role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" />');\n\t\t},\n\t\t\n\t\tUploadProgress: function(up, file) {\n\t\t\t$('#' + file.id + 'progress .progress-bar').css('width', file.percent + '%').html(file.percent + ' %');\n\t\t},\n\t\t\n\t\tError: function(up, err) {\n\t\t\t$('#' + err.file.id + 'progress').remove();\n\t\t\t$('#' + err.file.id + \"\").html(err.file.name + ' <span class=\"glyphicon glyphicon-remove-sign upload-error\" aria-hidden=\"true\"></span>');\n\t\t\t\n\t\t\tup.refresh(); // Reposition Flash/Silverlight */\n\t\t},\n\t\t\n\t\tFileUploaded: function(up, file, response) {\n\t\t\t$('#' + file.id + 'progress').remove();\n\t\t\t\n\t\t\tvar obj = JSON.parse(response.response); // parse JSON response\n\t\t\t// check for server-side error\n\t\t\tif (typeof(obj.status) != 'undefined' && obj.status == 'ok') {\n\t\t\t\tredirect = obj.redirect;\n\t\t\t\t$('#' + file.id).html(file.name + ' <span class=\"glyphicon glyphicon-ok-sign upload-success\" aria-hidden=\"true\"></span>');\n\t\t\t} else {\n\t\t\t\tup.trigger(\"Error\", {\n\t\t\t\t\tmessage: obj.error.message,\n\t\t\t\t\tcode: obj.error.code,\n\t\t\t\t\tfile: file});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t\n\t\tUploadComplete: function(up, files) {\n\t\t\twindow.location = redirect;\n\t\t}\n\t}\n});\n\nuploader.init();\n\nwindow.addEventListener('dragenter', function (e) {\n\tif (uploading) return;\n\t\n\te.stopPropagation();\n\te.preventDefault();\n\t\n\t$('#dropbox').fadeIn();\n\t\t\n}, false);\n\nvar dropbox = document.getElementById('dropbox');\t\t\t\nvar dropboxHideTimer;\n\ndropbox.addEventListener('dragover', function(e) {\n\te.stopPropagation();\n\te.preventDefault();\n\t\n\tclearTimeout(dropboxHideTimer);\n\tdropboxHideTimer = setTimeout(\"$('#dropbox').fadeOut();\", 250);\n}, false);\n\nfunction scrollTo(element) {\n\t$('html, body').animate({\n\t\tscrollTop: element.offset().top\n\t}, 2000);\n}\n\nfunction imgpopover_getTitle() {\n\tvar file = uploader.getFile($(this).data('file'));\n\treturn file.name;\n}\n\nfunction imgpopover_getContent() {\n\tvar file = uploader.getFile($(this).data('file'));\n\tvar source = file.getSource();\n\tvar img = new moxie.image.Image();\n\timg.onload = function() {\n\t\t$('#img' + file.id).attr('src', this.getAsDataURL());\n\t}\n\timg.load(source);\n\treturn '<img id=\"img' + file.id + '\" class=\"img-responsive\" />';\n}\n\n$('#image-list').delegate('.img-remove', 'click', function () {\n\tuploader.removeFile($(this).data('file'));\n});\n\n$('body').popover({\n\thtml: true,\n\ttrigger: 'hover focus',\n\tselector: '.img-popover',\n\ttemplate: '<div class=\"popover\" role=\"tooltip\"><h3 class=\"popover-title\"></h3><div class=\"popover-content\"></div></div>',\n\ttitle: imgpopover_getTitle,\n\tcontent: imgpopover_getContent,\n});\n\n//=== Clipboard ================================================================\n\ndocument.onkeydown = function(e) { return on_keyboard_action(e); }\ndocument.onkeyup = function(e) { return on_keyboardup_action(e); }\n\nvar ctrl_pressed = false;\n\nfunction on_keyboard_action(event){\n\tk = event.keyCode;\n\t//ctrl\n\tif (k==17) {\n\t\tif(ctrl_pressed == false)\n\t\t\tctrl_pressed = true;\n\t\tif (!window.Clipboard)\n\t\t\tpasteCatcher.focus();\n\t}\n}\nfunction on_keyboardup_action(event) {\n\tk = event.keyCode;\n\t//ctrl\n\tif(k==17)\n\t\tctrl_pressed = false;\n}\n\n//firefox\nvar pasteCatcher;\nif (!window.Clipboard) {\n\tpasteCatcher = document.createElement(\"div\");\n\tpasteCatcher.setAttribute(\"id\", \"paste_ff\");\n\tpasteCatcher.setAttribute(\"contenteditable\", \"\");\n\tpasteCatcher.style.cssText = 'opacity:0;position:fixed;top:0px;left:0px;';\n\tpasteCatcher.style.marginLeft = \"-20px\";\n\tdocument.body.appendChild(pasteCatcher);\n\tpasteCatcher.focus();\n\n\tdocument.getElementById('paste_ff').addEventListener('DOMSubtreeModified', function() {\n\t\tif(pasteCatcher.children.length == 1){\n\t\t\timg = pasteCatcher.firstElementChild.src;\n\n\t\t\tvar blob = dataURLtoBlob(img);\n\n\t\t\tpaste_createImage(blob);\n\t\t\tpasteCatcher.innerHTML = '';\n\t\t}\n\t}, false);\n}\n\nfunction dataURLtoBlob(dataurl) {\n    var arr = dataurl.split(',');\n    var mime = arr[0].match(/:(.*?);/)[1];\n    var bstr = atob(arr[1]);\n    var n = bstr.length\n    var u8arr = new Uint8Array(n);\n    while(n--){\n        u8arr[n] = bstr.charCodeAt(n);\n    }\n    return new Blob([u8arr], {type:mime});\n}\n\nfunction pasteHandler(e) {\n\tif(e.clipboardData) {\n\t\tvar items = e.clipboardData.items;\n\t\tif (items) {\n\t\t\tfor (var i = 0; i < items.length; i++) {\n\t\t\t\tif (items[i].type.indexOf(\"image\") !== -1) {\n\t\t\t\t\tvar blob = items[i].getAsFile();\n\t\t\t\t\t//var URLObj = window.URL || window.webkitURL;\n\t\t\t\t\t//var source = URLObj.createObjectURL(blob);\n\t\t\t\t\tpaste_createImage(blob);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tsetTimeout(paste_check_Input, 1);\n\t}\n}\n\n//chrome\nwindow.addEventListener(\"paste\", pasteHandler);\n\nfunction paste_check_Input() {\n\tvar child = pasteCatcher.childNodes[0];\n\tpasteCatcher.innerHTML = \"\";\n\tif (child) {\n\t\tif (cild.tagName === \"IMG\") {\n\t\t\tpaste_createImage(child.src);\n\t\t}\n\t}\n}\n\nfunction pad(number) {\n\treturn ('0' + number).slice(-2);\n}\n\nfunction getDateString() {\n\tvar date = new Date();\n\treturn date.getFullYear() + '-' + pad(date.getMonth() + 1) + '-' + pad(date.getDate()) + \n\t\t'_' + pad(date.getHours()) + pad(date.getMinutes()) + pad(date.getSeconds());\n}\n\nfunction getExtension(blob) {\n\tswitch(blob.type) {\n\tcase 'image/gif':\n\t\treturn '.gif';\n\tcase 'image/jpeg':\n\t\treturn '.jpg'\n\tcase 'image/png':\n\t\treturn '.png';\n\tcase 'image/bmp':\n\t\treturn '.bmp';\n\t}\n}\n\nfunction paste_createImage(blob) {\n\t//Add do plupload\n\tvar image = new moxie.image.Image();\n\tvar file = new moxie.file.File(null, blob);\n\tfile.name = 'clipboard-' + getDateString() + getExtension(blob);\n\tuploader.addFile(file);\n}\n\n//=== /Clipboard ===============================================================\n}","function onGooglePlatformSignIn(googleUser) {\n\tvar id_token = googleUser.getAuthResponse().id_token;\n\tvar url = $('#g-signin-button').data('loginpage');\n\t$.post(url, { 'id_token': id_token }, function(data) {\n\t\tif (typeof(data.status) != 'undefined' && data.status == 'ok') {\n\t\t\tvar url = $('#site-navigation').data('reload');\n\t\t\t$.get(url, function(data) {\n\t\t\t\t$('#site-navigation').replaceWith(data);\n\t\t\t});\n\t\t} else {\n\t\t\tsignOut();\n\t\t}\n\t});\n}\n\n\nfunction onGooglePlatformSignInFailure(error) {\n\tconsole.log(error);\n}\n\nfunction onGooglePlatformLoaded() {\n\tgapi.load('auth2', function() {\n\t\tvar auth2 = gapi.auth2.init();\n\t\tgapi.signin2.render('g-signin-button', {\n\t\t\t'scope': 'email',\n\t\t\t'onsuccess': onGooglePlatformSignIn,\n\t\t\t'onfailure': onGooglePlatformSignInFailure\n\t\t});\n\t});\n}\n\nfunction serverSignOut() {\n\tvar url = $('#g-signout-button').data('logoutpage');\n\t$.get(url, function(data) {\n\t\tlocation.reload(true);\n\t});\n}\n\nfunction signOut() {\n\tvar auth2 = gapi.auth2.getAuthInstance();\n\tauth2.signOut().then(serverSignOut);\n}\n\n$('#g-signout-button').click(function() {\n\tsignOut();\n});","if (typeof blueimp !== 'undefined') {\n\n$('#blueimp-gallery')\n\t.on('open', function (event) {\n\t\t$('meta[name=viewport]').attr('content', 'width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no');\n\t})\n\t.on('closed', function (event) {\n\t\t$('meta[name=viewport]').attr('content', 'width=device-width, initial-scale=1');\n\t})\n\t.on('slide', function (event, index, slide) {\n\t\tvar gallery = $('#blueimp-gallery').data('gallery');\n\t\tvar item = $(gallery.list[index]);\n\n\t\t$.bbq.pushState({'viewer': item.data('id')});\n\t})\n\t.on('close', function (event, index) {\n\t\t$.bbq.removeState('viewer');\n\t});\n\n$(window).hashchange(function() {\n\tvar gallery = $('#blueimp-gallery').data('gallery');\n\tif (typeof gallery === 'undefined') return;\n\n\tvar id = $.bbq.getState('viewer');\n\tif (typeof id === 'undefined') {\n\t\tgallery.close();\n\t\treturn;\n\t}\n\n\tfor (var i = 0; i < gallery.list.length; i++) {\n\t\tvar item = $(gallery.list[i]);\n\t\tif (item.data('id') == id) {\n\t\t\tif (gallery.getIndex() != i) {\n\t\t\t\tgallery.slide(i);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n});\n\n$(document).ready(function () {\n\tvar id = $.bbq.getState('viewer');\n\tif (typeof id !== 'undefined') {\n\t\t$('a[data-id=\"' + id + '\"').click()\n\t}\n});\n}\n\n","if (typeof $.fn.select2 !== 'undefined') {\n\t$(\"#inputtags\").select2({\n\t\t// enable tagging\n\t\ttags: true,\n\t\ttokenSeparators: [','],\n\t\tajax: {\n\t\t\tdelay: 250,\n\t\t\tprocessResults: function (data, page) {\n\t\t\t\treturn {\n\t\t\t\t\tresults: data\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t});\n}"]}